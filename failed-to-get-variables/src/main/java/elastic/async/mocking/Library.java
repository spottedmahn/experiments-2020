/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package elastic.async.mocking;

import java.util.concurrent.CompletableFuture;

import org.elasticsearch.action.ActionListener;
import org.elasticsearch.action.DocWriteResponse.Result;
import org.elasticsearch.action.index.IndexRequest;
import org.elasticsearch.action.index.IndexResponse;
import org.elasticsearch.client.RequestOptions;
import org.elasticsearch.client.RestHighLevelClient;

import lombok.RequiredArgsConstructor;

@RequiredArgsConstructor
public class Library {

    private final RestHighLevelClient restHighLevelClient;

    CompletableFuture<Boolean> doIt(Object customer) {

        var result = new CompletableFuture<Boolean>();
        var indexRequest = new IndexRequest();
    
        restHighLevelClient.indexAsync(indexRequest, RequestOptions.DEFAULT
             , new ActionListener<IndexResponse>() {
          @Override
          public void onResponse(IndexResponse indexResponse) { 
            if (indexResponse.getResult() == Result.UPDATED) {
              result.complete(false);
            }
            result.complete(true);
          }
    
          @Override
          public void onFailure(Exception e) {
            result.complete(false);
          }
        });
    
        return result;
      }
}
